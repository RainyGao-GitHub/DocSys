<!DOCTYPE html>
<html style="height: 100%;">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Office Editor</title>
    <script type="text/javascript" src="js/common.js"></script>
    <script type="text/javascript" src="js/DocSys.js"></script>
    <script type="text/javascript" src="http://localhost/web-apps/apps/api/documents/api.js"></script>
</head>
<body style="height: 100%; margin: 0;">
    <div id="placeholder" style="height: 100%"></div>
    <script type="text/javascript">
	    var docInfo = {};
	    docInfo.reposId = getQueryString("reposId");
	    docInfo.docId = getQueryString("docId");
	    docInfo.path = getQueryString("path");
	    docInfo.name = getQueryString("name");
	    
	    var title = docInfo.name;
	    var key = docInfo.docId + "";
	    var fileLink = getQueryString("fileLink");	    
	    if(!fileLink || fileLink == "")
	    {
	    	fileLink = getDocDownloadFullLink(docInfo);
	    }
	    var fileType = getFileSuffix(name);
	    var documentType = getDocumentType(fileType);
	    
	    console.log("showOffice() title=" + title + " key=" + key + " fileType=" + fileType + " documentType=" + documentType + " fileLink="+fileLink);
	    
        window.docEditor = new DocsAPI.DocEditor("placeholder",
            {
                "document": {
                    "fileType": fileType,
                    "key": key,
                    "title": title,
                    "url": fileLink,
                },
                "documentType": documentType,
                //"editorConfig": {
                //    "callbackUrl": "<?php cbUrl(); ?>",
                //    "lang": "zh-CN",
                //},
                "height": "100%",
                "width": "100%"
            });
        
        function getDocumentType(fileType)
        {
        	var documentTypeMap = {
        	        doc		:	"text",
        	        docm 	:	"text",
        	        docx	:	"text",
        	        dot 	:	"text",
        	        dotm	:	"text",
        	        dotx 	:	"text",
        	        doc		:	"text",
        			docx 	:	"text",	
        			epub	:	"text",
        			fodt 	:	"text",
        			htm		:	"text",
        			htmk 	:	"text",
        	        mht		:	"text",
        	        odt		:	"text",
        	        pdf		:	"text",
        			rtf 	:	"text",	
        			txt 	:	"text",	
        			djvu 	:	"text",	
        			xps 	:	"text",	
        			fodp 	: 	"presentation",
        		    odp 	: 	"presentation",
        		    potm	:	"presentation",
        		    pot 	: 	"presentation",
        		    potx 	:	"presentation",
        		    pps 	: 	"presentation",
        		    ppsm 	: 	"presentation",
        		    ppsx 	: 	"presentation",
        		    ppt 	: 	"presentation",
        		    pptm 	: 	"presentation",
        		    pptx 	: 	"presentation",
        		    csv 	: 	"spreadsheet",
        		    fods 	: 	"spreadsheet",
        		    ods 	: 	"spreadsheet",
        			xls 	: 	"spreadsheet",
        			xlsm 	: 	"spreadsheet",
        	        xlsx 	: 	"spreadsheet",
        	        xlt 	: 	"spreadsheet",
        			xltm 	: 	"spreadsheet",
        			xltx 	: 	"spreadsheet",
        	};
        }
    </script>
</body>
</html>