<!DOCTYPE html>
<html style="height: 100%;">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>ONLYOFFICE Api Documentation</title>
</head>
<body style="height: 100%; margin: 0;">
    <div id="placeholder" style="height: 100%"></div>
    <script type="text/javascript" src="http://localhost/web-apps/apps/api/documents/api.js"></script>

    <script type="text/javascript">
		//var  fileType = getQueryString("fileType");
	    var fileLink = getQueryString("fileLink");
	    //var title = getQueryString("title");
	    //var key = getQueryString("key");
	    
	    console.log("showOffice() fileLink:"+fileLink);
	    
        window.docEditor = new DocsAPI.DocEditor("placeholder",
            {
                "document": {
                    "fileType": "docx",
                    "key": "5545252352352",
                    "title": "test.docx",
                    "url": fileLink,
                },
                "documentType": "text",
                //"editorConfig": {
                //    "callbackUrl": "<?php cbUrl(); ?>",
                //    "lang": "zh-CN",
                //},
                "height": "100%",
                "width": "100%"
            });

        // 从 url 中获取参数
        function getQueryString(name) {
            var reg = new RegExp('(^|&)' + name + '=([^&]*)(&|$)', 'i');
            var r = window.location.search.substr(1).match(reg);
            if (r != null) {
                return unescape(r[2]);
            }
            return null;
        }
    </script>
</body>
</html>