<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>课程详情</title>
    <style type="text/css">
    </style>
    <script src="static/scripts/jquery.min.js"></script>
    <script src="static/pdfjs/build/pdf.js"></script>
    <script src="static/pdfjs/build/pdf.worker.js"></script>
</head>
<body>
  
	<h1>PDF.js Previous/Next example</h1>  

	<div>  
	  <button id="View">预览</button>  
	  <button id="Close">Close</button>  
	</div>
		  
	<div>  
	  <button id="prev">Previous</button>  
	  <button id="next">Next</button>  
	       
	  <span>Page: <span id="page_num"></span> / <span id="page_count"></span></span>  
	</div>  
	  
	<canvas id="the-canvas"></canvas>  
    <script type="text/javascript">
        var url = "static/pdfjs/web/compressed.tracemonkey-pldi-09.pdf"; 
        console.log("url:",url);
        
        PDFJS.workerSrc = "static/pdfjs/build/pdf.worker.js";
        console.log("PDFJS.workerSrc:",PDFJS.workerSrc);
          
        var pdfDoc = null;
        var pageNum = 1;  
        var pageRendering = false;
        var pageNumPending = null;
        var scale = 2;
        var canvas = document.getElementById("the-canvas");  
        var ctx = canvas.getContext("2d");
        
        function renderPage(num) 
        {
          	console.log("renderPage:" + num);
          	pageRendering = true;  
          	pdfDoc.getPage(num).then(function(page) 
          	{  
	            var viewport = page.getViewport(scale);  
	            canvas.height = viewport.height;  
	            canvas.width = viewport.width;  
	          
	            var renderContext = {  
	              canvasContext: ctx,  
	              viewport: viewport  
	            };  
            	var renderTask = page.render(renderContext);  
          
            	renderTask.promise.then(function() 
            	{  
		              pageRendering = false;  
		              if (pageNumPending !== null) {  
		                // New page rendering is pending  
		                renderPage(pageNumPending);  
		                pageNumPending = null;  
		              }  
	            });  
          	});  
          
          	document.getElementById('page_num').textContent = pageNum;  
        }  
          
        function queueRenderPage(num) 
        {  
	          if (pageRendering) 
	          {  
	            	pageNumPending = num;  
	          } 
	          else 
	          {  
            		renderPage(num);  
          	  }  
        }  
          
        function onPrevPage() 
        {  
	          if (pageNum <= 1) {  
	            return;  
	          }  
	          pageNum--;  
	          queueRenderPage(pageNum);  
        }  
        document.getElementById('prev').addEventListener('click', onPrevPage);  
          
        function onNextPage() 
        {  
          	if (pageNum >= pdfDoc.numPages) {  
            	return;  
          	}  
          	pageNum++;  
          	queueRenderPage(pageNum);  
        }  
        document.getElementById('next').addEventListener('click', onNextPage);  
        
        function onClosePage()
        {
        	var canvas = document.getElementById("the-canvas");
        	canvas.style.display = "none";
        }
        
        document.getElementById('Close').addEventListener('click', onClosePage); 
        
        function onViewPage()
        {
            PDFJS.getDocument(url).then(function(pdfDoc_) 
           	{
            	console.log("getDocumentCallBack:",pdfDoc);
    			pdfDoc = pdfDoc_;  
    			document.getElementById('page_count').textContent = pdfDoc.numPages;  
    			
    			renderPage(pageNum);  
            });
        	var canvas = document.getElementById("the-canvas");
        	canvas.style.display = "block";
        }
        document.getElementById('View').addEventListener('click', onViewPage); 
         
    </script>	
	
</body>
</html>