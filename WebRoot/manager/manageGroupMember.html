<div id="groupMemberContainer"></div>

<script type="text/javascript">
	function manageGroupMemberPageInit()
	{
		console.log("manageGroupMemberPageInit");
		showGroupAllUserList(0);		
	}

        
    //页面初始化代码    
    $(function(){
		manageGroupMemberPageInit();
	});


function showGroupAllUserList(groupId){
   	console.log("showGroupAllUserList()");
   	
   	$.ajax({
            url : "/DocSystem/Manage/getGroupAllUsers.do",
            type : "post",
            dataType : "json",
            data : {
            	groupId:groupId,
            },
            success : function (ret) {
                if( "ok" == ret.status ){
                	console.log("groupAllUsers:",ret.data);
                	var memberList = ret.data;
                	GroupMemberListDisplay(memberList,groupId);
                }
                else
                {
                	alert("Error:" + ret.msgInfo);
                }
            },
            error : function () {
               alert('服务器异常：获取用户列表失败！');
            }
    });
}

function GroupMemberListDisplay(list,groupId)
{
	console.log("GroupMemberListDisplay", groupId);
	$Func.render($("#groupMemberContainer"),"groupMember",{"list":list,"groupId":groupId});
}

function addGroupMember(userId,groupId)
{
   	console.log("addUserToGroup userId:" + userId+ " groupId" + groupId);
   
    $.ajax({
            url : "/DocSystem/Repos/addGroupMember.do",
            type : "post",
            dataType : "json",
            data : {
            	userId: userId,
                groupId : groupId,
            },
            success : function (ret) {
                if( "ok" == ret.status ){
                	showGroupAllUserList(groupId);		//更新显示
                }
                else
                {
                	showErrorMessage("Error:" + ret.msgInfo);
                }
            },
            error : function () {
               showErrorMessage('服务器异常：获取用户列表失败！');
            }
    });
}


function deleteGroupMemeberConfirm(id,groupId,userId)
{
		qiao.bs.confirm({
 	    	id: 'deleteGroupMemeberConfirm',
 	        msg: "是否删除该成员?",
 	        close: false,		
 	        okbtn: "删除",
 	        qubtn: "取消",
 	    },function () {
 	    	
 	    	//alert("点击了确定");
 	    	deleteGroupMemeber(id,groupId,userId);
 	    	return true;   
 	    },function(){
 	    	//alert("点击了取消");
 	    	return true;
 	    }); 
}

function deleteGroupMember(id,groupId,userId)
{	
   	console.log("deleteGroupMember() id:" + id + " groupId:" + groupId + " userId:" + userId);
   	
    $.ajax({
            url : "/DocSystem/Repos/deleteGroupMember.do",
            type : "post",
            dataType : "json",
            data : {
            	id: id,
                groupId: groupId,
                userId: userId,
            },
            success : function (ret) {
                if( "ok" == ret.status ){
                	showGroupAllUserList(groupId);
                }
                else
                {
                	showErrorMessage("Error:" + ret.msgInfo);
                }
            },
            error : function () {
               showErrorMessage('服务器异常：删除成员失败！');
            }
    });
}
</script>
